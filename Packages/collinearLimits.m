(* ::Package:: *)

Get["HPL_collinear_expansion_terms.dat"];
Do[Get["weight_"<>ToString[n]<>"_collinear_irreducible_functions_wfec.dat"],{n,3,7}];

uwToS={u -> S^2/(1 + S^2), w -> (1 + S^2)^(-1)};
\[CapitalDelta]toFST={Power[\[CapitalDelta],-1/2]->(T^2+1)(F^2 S T+F(S^2+T^2+1)+S T)/((F^2-1)S T)};
uvwToFST={u->1-((1+F*S*T+T^2)*(F+S*T+F*T^2))/((1+T^2)*(F+F*S^2+S*T+F^2*S*T+F*T^2)),v->1-(1+T^2)^(-1),w->1-((F*S+T)*(S+F*T))/(F+F*S^2+S*T+F^2*S*T+F*T^2),yu->(F*S+T)/(F*(S+F*T)),yv->((S+F*T)*(1+F*S*T+T^2))/((F*S+T)*(F+S*T+F*T^2)),yw->(F+S*T+F*T^2)/(F*(1+F*S*T+T^2))};
uvwToFSTemp={1-u->((1+F*S*Temp+Temp^2)*(F+S*Temp+F*Temp^2))/((1+Temp^2)*(F+F*S^2+S*Temp+F^2*S*Temp+F*Temp^2)),1-v->(1+Temp^2)^(-1),1-w->((F*S+Temp)*(S+F*Temp))/(F+F*S^2+S*Temp+F^2*S*Temp+F*Temp^2),yu->(F*S+Temp)/(F*(S+F*Temp)),yv->((S+F*Temp)*(1+F*S*Temp+Temp^2))/((F*S+Temp)*(F+S*Temp+F*Temp^2)),yw->(F+S*Temp+F*Temp^2)/(F*(1+F*S*Temp+Temp^2)),T->Temp};
simplifyArgsInS[func_]:=Expand[func/.HPL[aVec_,arg_]:>HPL[aVec,Simplify[arg/.T->0]]/.invertArgument[S^2/(S^2+1),\[Delta]]/.{HPL[aVec_,var_]:>HPL[aVec,Simplify[var]]}/.flipArgument[{1/S^2+1,1-1/(S^2+1)}]/.invertArgument[{-1/S^2,1/(S^2+1)},\[Delta]]/.flipArgument[S^2+1]/.{HPL[{0},-S^2]->Log[S^2]-I Pi}]/.\[Pi]to\[Zeta];
irreducibleFunctionsToCollinearExpansion[order_]:={H3[a_]:>collinearExpansionOrder[H3[a],order,u],H4[a_]:>collinearExpansionOrder[H4[a],order,u],H5[a_]:>collinearExpansionOrder[H5[a],order,u],H6[a_]:>collinearExpansionOrder[H6[a],order,u],E7[a_]:>collinearExpansionOrder[E7[a],order,u],O7[a_]:>collinearExpansionOrder[O7[a],order,u],H8[a_]:>collinearExpansionOrder[H8[a],order,u],H9[a_]:>collinearExpansionOrder[H9[a],order,u],H10[a_]:>collinearExpansionOrder[H10[a],order,u],Subscript[OverTilde[\[CapitalPhi]],6]:>collinearExpansionOrder[Subscript[OverTilde[\[CapitalPhi]],6],order,u],Superscript[\[CapitalOmega],"(2)"][a_,b_,c_]:>collinearExpansionOrder[Superscript[\[CapitalOmega],"(2)"][a,b,c],order,u],Subscript[F,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[F,1][s,b,c],order,u],Subscript[H,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[H,1][s,b,c],order,u],Subscript[J,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[J,1][s,b,c],order,u],N:>collinearExpansionOrder[N,order,u],O:>collinearExpansionOrder[O,order,u],Subscript[M,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[M,1][s,b,c],order,u],Subscript[Q,"ep"][a_,b_,c_]:>collinearExpansionOrder[Subscript[Q,"ep"][a,b,c],order,u],G:>collinearExpansionOrder[G,order,u],Subscript[K,1][a_,b_,c_]:>collinearExpansionOrder[Subscript[K,1][a,b,c],order,u]};
coproductD[func_,T]:=-(((1+F^2)*S)/(F*(1+S^2)))coproductEntry[func,u]+(2/T)coproductEntry[func,v]-(((1+F^2)*S)/(F*(1+S^2)))coproductEntry[func,w]+(((1+F^2)*S^3)/(F*(1+S^2)))coproductEntry[func,1-u]+((1+F^2)/(F*S*(1+S^2)))coproductEntry[func,1-w]+((1-F^2)/(F*S))coproductEntry[func,yu]+(((-1+F)*(1+F)*(1+S^2))/(F*S))coproductEntry[func,yv]-(((-1+F)*(1+F)*S)/F)coproductEntry[func,yw];
simplifyFSprefactors[func_]:=Module[{funcList=If[MatchQ[Expand[func],Plus[_,__]],List@@Expand[func],{Expand[func]}],simplifyPrefactor,sendSumsToLists},sendSumsToLists[term_]:=If[MatchQ[Apart[term],Plus[_,__]],List@@Apart[term],Apart[term]];simplifyPrefactor[term_]:=Expand[(Times@@Select[List@@term,FreeQ[#1,Alternatives[S,F]]&])Apart[Times@@Select[List@@term,!FreeQ[#1,F]&]]Apart[Times@@Select[List@@term,!FreeQ[#1,S]&]]]/;MatchQ[term,Times[_,__]];simplifyPrefactor[term_]:=term/;!MatchQ[term,Times[_,__]];Expand[Plus@@(simplifyPrefactor/@Flatten[sendSumsToLists/@(Thread[Apart[funcList]]/.{HPL[aVec_,arg_]:>HPL[aVec,arg/.{T->Temp,S->Semp}],Log[arg_]:>Log[arg/.{T->Temp,S->Semp}]})])/.{Temp->T,Semp->S}]]

dT[func_,0,u]:=(dT[func,0,u]=0)/;OddQ[yGrading[func]];
dT[func_,0,u]:=(dT[func,0,u]=Expand[toLineE[func,{u,0,1-u}]/.{Log[Subscript[\[Xi],u]]->2*Log[T]}/.uwToS/.invertArgument[S^2/(S^2+1),\[Delta]]/.{HPL[aVec_,var_]:>HPL[aVec,Expand[var]]}/.flipArgument[1/S^2+1]/.invertArgument[-1/S^2,\[Delta]]/.{HPL[{0},v]->2Log[T]}/.{HPL[{0},-S^2]->Log[S^2]+I Pi}]/.\[Pi]to\[Zeta])/;EvenQ[yGrading[func]];
dT[func_,n_,u]:=(dT[func,n,u]=simplifyFSprefactors[Simplify[Expand[simplifyArgsInS[Normal[Series[D[Normal[Series[Sum[coproductD[func,var]D[var/.uvwToFST,T],{var,{u,v,w}}]/.toHPL/.HPL[aVec_,arg_]:>HPLexpand[HPL[aVec,arg/.uvwToFST],{T,0,3}]/.irreducibleFunctionsToCollinearExpansion[3]/.\[CapitalDelta]toFST/.uvwToFST,{T,0,n-1}]],{T,n-1}],{T,0,0}]]]]]])/;n>0;

collinearExpansionTerm[func_,0,0,u]:= collinearExpansionTerm[func,0,0,u]= simplifyFSprefactors[ReplaceAll[dT[func,0,u],Log[T]->0]];
collinearExpansionTerm[func_,0,n_,u]:= collinearExpansionTerm[func,0,n,u]= simplifyFSprefactors[Coefficient[dT[func,0,u],Log[T]^n]];
collinearExpansionTerm[func_,t_,n_,u]:= (collinearExpansionTerm[func,t,n,u]= 0)/;(n>transcendentalWeight[func]-2);
collinearExpansionTerm[func_,t_,n_,u]:= (collinearExpansionTerm[func,t,n,u]= simplifyFSprefactors[Coefficient[dT[func,t,u],Log[T]^n]/(t!)])/;(n==transcendentalWeight[func]-2);
collinearExpansionTerm[func_,1,n_,u]:= (collinearExpansionTerm[func,1,n,u]= simplifyFSprefactors[Coefficient[dT[func,1,u],Log[T]^n]-(n+1)*collinearExpansionTerm[func,1,n+1,u]-(n+1)*collinearExpansionTerm[func,0,n+1,u]/T])/;(n<transcendentalWeight[func]-2)\[And](n>0);
collinearExpansionTerm[func_,1,0,u]:= collinearExpansionTerm[func,1,0,u]= simplifyFSprefactors[ReplaceAll[dT[func,1,u],Log[T]->0]-collinearExpansionTerm[func,1,1,u]-collinearExpansionTerm[func,0,1,u]/T]; 
collinearExpansionTerm[func_,2,n_,u]:= (collinearExpansionTerm[func,2,n,u]= simplifyFSprefactors[Coefficient[dT[func,2,u],Log[T]^n]/2 - (1+n)(3*collinearExpansionTerm[func,2,n+1,u] + collinearExpansionTerm[func,1,n+1,u]/T - collinearExpansionTerm[func,0,n+1,u]/T^2)/2])/;(n==transcendentalWeight[func]-3)\[And](n>0);
collinearExpansionTerm[func_,2,n_,u]:= (collinearExpansionTerm[func,2,n,u]= simplifyFSprefactors[Coefficient[dT[func,2,u],Log[T]^n]/2 - ((n^2+3n+2)*collinearExpansionTerm[func,2,n+2,u] + 3(n+1)*collinearExpansionTerm[func,2,n+1,u] + (n^2+3n+2)*collinearExpansionTerm[func,1,n+2,u]/T + (n+1)*collinearExpansionTerm[func,1,n+1,u]/T + (n^2+3n+2)*collinearExpansionTerm[func,0,n+2,u]/T^2 - (n+1)*collinearExpansionTerm[func,0,n+1,u]/T^2)/2])/;(n<=transcendentalWeight[func]-4)\[And](n>0);
collinearExpansionTerm[func_,2,0,u]:= collinearExpansionTerm[func,2,0,u]= simplifyFSprefactors[ReplaceAll[dT[func,2,u],Log[T]->0]/2 + collinearExpansionTerm[func,0,1,u]/(2*T^2) - collinearExpansionTerm[func,0,2,u]/T^2 - collinearExpansionTerm[func,1,1,u]/(2*T) - collinearExpansionTerm[func,1,2,u]/T - 3*collinearExpansionTerm[func,2,1,u]/2 - collinearExpansionTerm[func,2,2,u]];
collinearExpansionTerm[func_,3,n_,u]:= (collinearExpansionTerm[func,3,n,u]= simplifyFSprefactors[Coefficient[dT[func,3,u],Log[T]^n]/6 - (n+1)(11*collinearExpansionTerm[func,3,n+1,u] + 2*collinearExpansionTerm[func,2,n+1,u]/T - collinearExpansionTerm[func,1,n+1,u]/T^2 + 2*collinearExpansionTerm[func,0,n+1,u]/T^3)/6])/;(n==transcendentalWeight[func]-3)\[And](n>0);
collinearExpansionTerm[func_,3,n_,u]:= (collinearExpansionTerm[func,3,n,u]= simplifyFSprefactors[Coefficient[dT[func,3,u],Log[T]^n]/6 - ((n^2+3n+2)*collinearExpansionTerm[func,3,n+2,u] + (11n+11)*collinearExpansionTerm[func,3,n+1,u]/6 + (n^2+3+2)*collinearExpansionTerm[func,2,n+2,u]/(2*T) + (n+1)*collinearExpansionTerm[func,2,n+1,u]/(3*T) - (n+1)*collinearExpansionTerm[func,1,n+1,u]/(6*T^2) - (n^2+3n+2)*collinearExpansionTerm[func,0,n+2,u]/(2*T^3) + (n+1)*collinearExpansionTerm[func,0,n+1,u]/(3*T^3))])/;(n==transcendentalWeight[func]-4)\[And](n>0);
collinearExpansionTerm[func_,3,n_,u]:= (collinearExpansionTerm[func,3,n,u]= simplifyFSprefactors[Coefficient[dT[func,3,u],Log[T]^n]/6 - (22+11*n)collinearExpansionTerm[func,3,n+1,u]/6 - (n+2)(2*collinearExpansionTerm[func,2,n+1,u]/T - collinearExpansionTerm[func,1,n+1,u]/T^2 + 2*collinearExpansionTerm[func,0,n+1,u]/T^3)/6 - (6+9*n+3*n^2)(2 collinearExpansionTerm[func,3,n+2,u] + collinearExpansionTerm[func,2,n+2,u]/T - collinearExpansionTerm[func,0,n+2,u]/T^3)/6 - (2*n+3*n^2+n^3)(collinearExpansionTerm[func,3,n+3,u] + collinearExpansionTerm[func,2,n+3,u]/T + collinearExpansionTerm[func,1,n+3,u]/T^2 + collinearExpansionTerm[func,0,n+3,u]/T^3)/6])/;(0<n<=transcendentalWeight[func]-5);
collinearExpansionTerm[func_,3,0,u]:= collinearExpansionTerm[func,3,0,u]= simplifyFSprefactors[ReplaceAll[dT[func,3,u],Log[T]->0]/6 - collinearExpansionTerm[func,0,1,u]/(3*T^3) + collinearExpansionTerm[func,0,2,u]/T^3 - collinearExpansionTerm[func,0,3,u]/T^3 + collinearExpansionTerm[func,1,1,u]/(6*T^2) - collinearExpansionTerm[func,1,3,u]/T^2 - collinearExpansionTerm[func,2,1,u]/(3*T) - collinearExpansionTerm[func,2,2,u]/T - collinearExpansionTerm[func,2,3,u]/T - 11*collinearExpansionTerm[func,3,1,u]/6 - 2*collinearExpansionTerm[func,3,2,u] - collinearExpansionTerm[func,3,3,u]];

collinearExpansionOrder[func_,o_,u]:=collinearExpansionOrder[func,o,u]=Expand[Sum[Sum[collinearExpansionTerm[func,i,j,u]*T^i*Log[T]^j,{j,0,transcendentalWeight[func]-2}],{i,0,o}]];


(*dT[func_,n_,u]:=(dT[func,n,u]=simplifyArgsInS[HPLseries[HPLfuncD[Simplify[Normal[Series[Expand[Normal[Series[Sum[coproductD[func,var]D[var/.uvwToFST,T],{var,{u,v,w}}],{T,0,n+1}]]]/.irreducibleFunctionsToCollinearExpansion/.toHPL/.HPL[aVec_,arg_]:>HPL[aVec,arg/.uvwToFSTemp]/.\[CapitalDelta]toFST/.uvwToFST,{T,0,n-1}]]/.Temp->T],{T,n-1}]/.{HPL[{1},1/(T^2+1)]:>(Log[1+T^2]-2 Log[T]),HPL[{1},1-T]->-Log[T],HPL[{1},1-S^2]->-Log[S^2]},{T,0,0}]])/;n>0;
*)

(*irreducibleFunctionsToCollinearExpansion[order_]:={Power[T,n_]*H3[a_]:>Power[T,n]*collinearExpansionOrder[H3[a],order-n,u],T*H3[a_]:>T*collinearExpansionOrder[H3[a],order-1,u],H3[a_]:>collinearExpansionOrder[H3[a],order,u],Power[T,n_]*H4[a_]:>Power[T,n]*collinearExpansionOrder[H4[a],order-n,u],T*H4[a_]:>T*collinearExpansionOrder[H4[a],order-1,u],H4[a_]:>collinearExpansionOrder[H4[a],order,u],Power[T,n_]*H5[a_]:>Power[T,n]*collinearExpansionOrder[H5[a],order-n,u],T*H5[a_]:>T*collinearExpansionOrder[H5[a],order-1,u],H5[a_]:>collinearExpansionOrder[H5[a],order,u],Power[T,n_]*H6[a_]:>Power[T,n]*collinearExpansionOrder[H6[a],order-n,u],T*H6[a_]:>T*collinearExpansionOrder[H6[a],order-1,u],H6[a_]:>collinearExpansionOrder[H6[a],order,u],Power[T,n_]*E7[a_]:>Power[T,n]*collinearExpansionOrder[E7[a],order-n,u],T*E7[a_]:>T*collinearExpansionOrder[E7[a],order-1,u],E7[a_]:>collinearExpansionOrder[E7[a],order,u],Power[T,n_]*O7[a_]:>Power[T,n]*collinearExpansionOrder[O7[a],order-n,u],T*O7[a_]:>T*collinearExpansionOrder[O7[a],order-1,u],O7[a_]:>collinearExpansionOrder[O7[a],order,u],Power[T,n_]*Subscript[OverTilde[\[CapitalPhi]],6]:>Power[T,n]*collinearExpansionOrder[Subscript[OverTilde[\[CapitalPhi]],6],order-n,u],T*Subscript[OverTilde[\[CapitalPhi]],6]:>T*collinearExpansionOrder[Subscript[OverTilde[\[CapitalPhi]],6],order-1,u],Subscript[OverTilde[\[CapitalPhi]],6]:>collinearExpansionOrder[Subscript[OverTilde[\[CapitalPhi]],6],order,u],Power[T,n_]*Superscript[\[CapitalOmega],"(2)"][a_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Superscript[\[CapitalOmega],"(2)"][a,b,c],order-n,u],T*Superscript[\[CapitalOmega],"(2)"][a_,b_,c_]:>T*collinearExpansionOrder[Superscript[\[CapitalOmega],"(2)"][a,b,c],order-1,u],Superscript[\[CapitalOmega],"(2)"][a_,b_,c_]:>collinearExpansionOrder[Superscript[\[CapitalOmega],"(2)"][a,b,c],order,u],Power[T,n_]*Subscript[F,1][s_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Subscript[F,1][s,b,c],order-n,u],T*Subscript[F,1][s_,b_,c_]:>T*collinearExpansionOrder[Subscript[F,1][s,b,c],order-1,u],Subscript[F,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[F,1][s,b,c],order,u],Power[T,n_]*Subscript[H,1][s_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Subscript[H,1][s,b,c],order-n,u],T*Subscript[H,1][s_,b_,c_]:>T*collinearExpansionOrder[Subscript[H,1][s,b,c],order-1,u],Subscript[H,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[H,1][s,b,c],order,u],Power[T,n_]*Subscript[J,1][s_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Subscript[J,1][s,b,c],order-n,u],T*Subscript[J,1][s_,b_,c_]:>T*collinearExpansionOrder[Subscript[J,1][s,b,c],order-1,u],Subscript[J,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[J,1][s,b,c],order,u],Power[T,n_]*N:>Power[T,n]*collinearExpansionOrder[N,order-n,u],T*N:>T*collinearExpansionOrder[N,order-1,u],N:>collinearExpansionOrder[N,order,u],Power[T,n_]*O:>Power[T,n]collinearExpansionOrder[O,order-n,u],T*O:>T*collinearExpansionOrder[O,order-1,u],O:>collinearExpansionOrder[O,order,u],Power[T,n_]*Subscript[M,1][s_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Subscript[M,1][s,b,c],order-n,u],T*Subscript[M,1][s_,b_,c_]:>T*collinearExpansionOrder[Subscript[M,1][s,b,c],order-1,u],Subscript[M,1][s_,b_,c_]:>collinearExpansionOrder[Subscript[M,1][s,b,c],order,u],Power[T,n_]*Subscript[Q,"ep"][a_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Subscript[Q,"ep"][a,b,c],order-n,u],T*Subscript[Q,"ep"][a_,b_,c_]:>T*collinearExpansionOrder[Subscript[Q,"ep"][a,b,c],order-1,u],Subscript[Q,"ep"][a_,b_,c_]:>collinearExpansionOrder[Subscript[Q,"ep"][a,b,c],order,u],Power[T,n_]*G:>Power[T,n]*collinearExpansionOrder[G,order-n,u],T*G:>T*collinearExpansionOrder[G,order-1,u],G:>collinearExpansionOrder[G,order,u],Power[T,n_]*Subscript[K,1][a_,b_,c_]:>Power[T,n]*collinearExpansionOrder[Subscript[K,1][a,b,c],order-n,u],T*Subscript[K,1][a_,b_,c_]:>T*collinearExpansionOrder[Subscript[K,1][a,b,c],order-1,u],Subscript[K,1][a_,b_,c_]:>collinearExpansionOrder[Subscript[K,1][a,b,c],order,u]};

dT0[func_,u]:=dT0[func,u]=Expand[toLineE[func,{u,0,1-u}]/.{Log[Subscript[\[Xi],u]]->2*Log[T]}/.uwToS/.invertArgument[S^2/(S^2+1)]/.{HPL[aVec_,var_]:>HPL[aVec,Expand[var]]}/.flipArgument[1/S^2+1]/.invertArgument[-1/S^2]/.{HPL[{0},v]->2Log[T]}/.{HPL[{0},-S^2]->Log[S^2]+I Pi}]/.\[Pi]to\[Zeta];
dT1[func_,u]:=dT1[func,u]=Expand[coproductD[func,T]/.toHPL/.flipArgument[{1-u,1-v}]/.uwToS/.invertArgument[S^2/(S^2+1)]/.{HPL[aVec_,var_]:>HPL[aVec,Expand[var]]}/.flipArgument[{1/S^2+1,1-1/(S^2+1)}]/.invertArgument[{-1/S^2,1/(S^2+1)}]/.flipArgument[S^2+1]/.{HPL[{0},v]->2Log[T]}/.{HPL[{0},-S^2]->Log[S^2]+I Pi}];
dT2[func_,u]:=simplifyFSprefactors[Normal[Series[Expand[HPLfuncD[Normal[Series[Sum[coproductD[func ,var]D[var/.uvwToFST,T],{var,{u,v,w}}]/.toHPL/.HPL[aVec_,arg_]:>HPL[aVec,arg/.uvwToFSTemp]/.{Power[\[CapitalDelta],-1/2]->(T^2+1)(F^2 S T+F(S^2+T^2+1)+S T)/((F^2-1)S T)}/.uvwToFST,{T,0,1}]]/.Temp->T,T]/.{HPL[{1},1-T^2/(T^2+1)]->-2Log[T],HPL[aVec_,arg_]:>HPL[aVec,Simplify[arg/.T->0]]}/.invertArgument[S^2/(S^2+1)]/.{HPL[aVec_,var_]:>HPL[aVec,Simplify[var]]}/.flipArgument[{1/S^2+1,1-1/(S^2+1)}]/.invertArgument[{-1/S^2,1/(S^2+1)}]/.flipArgument[S^2+1]/.{HPL[{0},-S^2]->Log[S^2]-I Pi}]/.\[Pi]to\[Zeta],{T,0,0}]]];*)

(*simplifyFSprefactors[func_]:=Module[{funcList=If[MatchQ[Expand[func],Plus[_,__]],List@@Expand[func],{Expand[func]}],simplifyPrefactor,sendSumsToLists},
	sendSumsToLists[term_]:=If[MatchQ[Apart[term],Plus[_,__]],List@@Apart[term],Apart[term]];
	simplifyPrefactor[term_]:=Expand[(Times@@Select[List@@term,FreeQ[#1,Alternatives[S,F]]&])Apart[Times@@Select[List@@term,!FreeQ[#1,F]&]]Apart[Times@@Select[List@@term,!FreeQ[#1,S]&]]]/;MatchQ[term,Times[_,__]];
	simplifyPrefactor[term_]:=term/;!MatchQ[term,Times[_,__]];
	Expand[Simplify[Apply[Plus,simplifyPrefactor/@Flatten[sendSumsToLists/@Thread[Apart[funcList]]]]/.{HPL[aVec_,arg_]:>HPL[aVec,arg/.{T->Temp,S->Semp}],Log[arg_]:>Log[arg/.{T->Temp,S->Semp}]}]/.{Temp->T,Semp->S}]]
dT[func_,n_,u]:=(dT[func,n,u]=simplifyFSprefactors[Normal[Series[Expand[HPLfuncD[Normal[Series[Sum[coproductD[func ,var]D[var/.uvwToFST,T],{var,{u,v,w}}]/.toHPL/.HPL[aVec_,arg_]:>HPL[aVec,arg/.uvwToFSTemp]/.{Power[\[CapitalDelta],-1/2]->(T^2+1)(F^2 S T+F(S^2+T^2+1)+S T)/((F^2-1)S T)}/.uvwToFST,{T,0,n-1}]]/.Temp->T,{T,n-1}]/.{HPL[{1},1-T^2/(T^2+1)]->-2Log[T],HPL[aVec_,arg_]:>HPL[aVec,Simplify[arg/.T->0]]}/.invertArgument[S^2/(S^2+1)]/.{HPL[aVec_,var_]:>HPL[aVec,Simplify[var]]}/.flipArgument[{1/S^2+1,1-1/(S^2+1)}]/.invertArgument[{-1/S^2,1/(S^2+1)}]/.flipArgument[S^2+1]/.{HPL[{0},-S^2]->Log[S^2]-I Pi}]/.\[Pi]to\[Zeta],{T,0,0}]]])/;n>0;*)
